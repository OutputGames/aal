\doxysection{Audio\+File.\+h}
\hypertarget{_audio_file_8h_source}{}\label{_audio_file_8h_source}\index{include/aal/AudioFile.h@{include/aal/AudioFile.h}}
\mbox{\hyperlink{_audio_file_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{00021\ \ \textcolor{comment}{//=======================================================================}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#ifndef\ \_AS\_AudioFile\_h}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#define\ \_AS\_AudioFile\_h}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <assert.h>}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ <fstream>}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ <iterator>}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{comment}{//\ disable\ some\ warnings\ on\ Windows}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#if\ defined\ (\_MSC\_VER)}}
\DoxyCodeLine{00037\ \_\_pragma(warning(push))}
\DoxyCodeLine{00038\ \_\_pragma(warning(disable\ :\ 4244))}
\DoxyCodeLine{00039\ \_\_pragma(warning(disable\ :\ 4457))}
\DoxyCodeLine{00040\ \_\_pragma(warning(disable\ :\ 4458))}
\DoxyCodeLine{00041\ \_\_pragma(warning(disable\ :\ 4389))}
\DoxyCodeLine{00042\ \_\_pragma(warning(disable\ :\ 4996))}
\DoxyCodeLine{00043\ \#elif\ defined\ (\_\_GNUC\_\_)}
\DoxyCodeLine{00044\ \_Pragma(\textcolor{stringliteral}{"{}GCC\ diagnostic\ push"{}})}
\DoxyCodeLine{00045\ \_Pragma(\textcolor{stringliteral}{"{}GCC\ diagnostic\ ignored\ \(\backslash\)"{}-\/Wconversion\(\backslash\)"{}"{}})}
\DoxyCodeLine{00046\ \_Pragma(\textcolor{stringliteral}{"{}GCC\ diagnostic\ ignored\ \(\backslash\)"{}-\/Wsign-\/compare\(\backslash\)"{}"{}})}
\DoxyCodeLine{00047\ \_Pragma(\textcolor{stringliteral}{"{}GCC\ diagnostic\ ignored\ \(\backslash\)"{}-\/Wshadow\(\backslash\)"{}"{}})}
\DoxyCodeLine{00048\ \#endif}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00055\ \ \ \ \ enum\ class\ \mbox{\hyperlink{_audio_file_8h_ad18559d169602e85d0ad68da6ef8593f}{AudioFileFormat}}}
\DoxyCodeLine{00056\ \{}
\DoxyCodeLine{00057\ \ \ \ \ Error,}
\DoxyCodeLine{00058\ \ \ \ \ NotLoaded,}
\DoxyCodeLine{00059\ \ \ \ \ Wave,}
\DoxyCodeLine{00060\ \ \ \ \ Aiff}
\DoxyCodeLine{00061\ \};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00064\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00065\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_audio_file}{AudioFile}}}
\DoxyCodeLine{00066\ \{}
\DoxyCodeLine{00067\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keyword}{typedef}\ std::vector<std::vector<T>\ >\ AudioBuffer;}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{class_audio_file_ae74399e93d3f4623c7421ee10cfc0e15}{AudioFile}}();}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a0ff16123b519a4665e9f3e7d341f0a26}{load}}(std::string\ filePath);}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a415239cad5b54b4fef4a210ab79911e3}{save}}(std::string\ filePath,\ \mbox{\hyperlink{_audio_file_8h_ad18559d169602e85d0ad68da6ef8593f}{AudioFileFormat}}\ format\ =\ AudioFileFormat::Wave);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00089\ \ \ \ \ uint32\_t\ \mbox{\hyperlink{class_audio_file_a8cd1b082af9db6bd180e4a63edcdefc9}{getSampleRate}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_audio_file_a514f860a956b4494ee8d8c806391d6b3}{getNumChannels}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a1057326fd2c2eca7cc7937f811868cf1}{isMono}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a380a188d95f8f23b7622dfe222a7e8f6}{isStereo}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_audio_file_a5495d5cb55911de54f0714e219130b48}{getBitDepth}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_audio_file_ae1b5b4b7351a79dbf810bb34ede496b9}{getNumSamplesPerChannel}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_audio_file_a5a6b01404675361b1c21c9c5fb5753d4}{getLengthInSeconds}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a7b88c68133a9ac92149c58499e026360}{printSummary}}()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_afa0a0f7d576b0597c938c5a89746636e}{setAudioBuffer}}(AudioBuffer\&\ newBuffer);}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_ac155ed12db0f3b02011a7d75b525e71a}{setAudioBufferSize}}(\textcolor{keywordtype}{int}\ numChannels,\ \textcolor{keywordtype}{int}\ numSamples);}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a4cff9513d49e21d25de13513564784b7}{setNumSamplesPerChannel}}(\textcolor{keywordtype}{int}\ numSamples);}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a354018a94ae15907d7308782f2adadbb}{setNumChannels}}(\textcolor{keywordtype}{int}\ numChannels);}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a2adf2ea23e7daeb8401e717c1b3d874b}{setBitDepth}}(\textcolor{keywordtype}{int}\ numBitsPerSample);}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a2d8fa306e40535113c3eba111e16483b}{setSampleRate}}(uint32\_t\ newSampleRate);}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a1986c0297e4e4db99435702528e9c3c4}{shouldLogErrorsToConsole}}(\textcolor{keywordtype}{bool}\ logErrors);}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00148\ \ \ \ \ AudioBuffer\ \mbox{\hyperlink{class_audio_file_af937119db095c5af870851050dcbeabb}{samples}};}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00153\ \ \ \ \ std::string\ \mbox{\hyperlink{class_audio_file_ab2bc14440b0a6ff1a297e28a0354d422}{iXMLChunk}};}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a1b675666e190365d171567af45512e01}{writePCMToBuffer}}(std::vector<uint8\_t>\&\ out);}
\DoxyCodeLine{00156\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keyword}{enum\ class}\ Endianness}
\DoxyCodeLine{00160\ \ \ \ \ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ LittleEndian,}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ BigEndian}
\DoxyCodeLine{00163\ \ \ \ \ \};}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00166\ \ \ \ \ \mbox{\hyperlink{_audio_file_8h_ad18559d169602e85d0ad68da6ef8593f}{AudioFileFormat}}\ determineAudioFileFormat(std::vector<uint8\_t>\&\ fileData);}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordtype}{bool}\ decodeWaveFile(std::vector<uint8\_t>\&\ fileData);}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keywordtype}{bool}\ decodeAiffFile(std::vector<uint8\_t>\&\ fileData);}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordtype}{bool}\ saveToWaveFile(std::string\ filePath);}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordtype}{bool}\ saveToAiffFile(std::string\ filePath);}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keywordtype}{void}\ clearAudioBuffer();}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00178\ \ \ \ \ int32\_t\ fourBytesToInt(std::vector<uint8\_t>\&\ source,\ \textcolor{keywordtype}{int}\ startIndex,\ Endianness\ endianness\ =\ Endianness::LittleEndian);}
\DoxyCodeLine{00179\ \ \ \ \ int16\_t\ twoBytesToInt(std::vector<uint8\_t>\&\ source,\ \textcolor{keywordtype}{int}\ startIndex,\ Endianness\ endianness\ =\ Endianness::LittleEndian);}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordtype}{int}\ getIndexOfString(std::vector<uint8\_t>\&\ source,\ std::string\ s);}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keywordtype}{int}\ getIndexOfChunk(std::vector<uint8\_t>\&\ source,\ \textcolor{keyword}{const}\ std::string\&\ chunkHeaderID,\ \textcolor{keywordtype}{int}\ startIndex,\ Endianness\ endianness\ =\ Endianness::LittleEndian);}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00184\ \ \ \ \ T\ sixteenBitIntToSample(int16\_t\ sample);}
\DoxyCodeLine{00185\ \ \ \ \ int16\_t\ sampleToSixteenBitInt(T\ sample);}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00188\ \ \ \ \ uint8\_t\ sampleToSingleByte(T\ sample);}
\DoxyCodeLine{00189\ \ \ \ \ T\ singleByteToSample(uint8\_t\ sample);}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ uint32\_t\ getAiffSampleRate(std::vector<uint8\_t>\&\ fileData,\ \textcolor{keywordtype}{int}\ sampleRateStartIndex);}
\DoxyCodeLine{00192\ \ \ \ \ \textcolor{keywordtype}{bool}\ tenByteMatch(std::vector<uint8\_t>\&\ v1,\ \textcolor{keywordtype}{int}\ startIndex1,\ std::vector<uint8\_t>\&\ v2,\ \textcolor{keywordtype}{int}\ startIndex2);}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{keywordtype}{void}\ addSampleRateToAiffData(std::vector<uint8\_t>\&\ fileData,\ uint32\_t\ sampleRate);}
\DoxyCodeLine{00194\ \ \ \ \ T\ clamp(T\ v1,\ T\ minValue,\ T\ maxValue);}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keywordtype}{void}\ addStringToFileData(std::vector<uint8\_t>\&\ fileData,\ std::string\ s);}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{keywordtype}{void}\ addInt32ToFileData(std::vector<uint8\_t>\&\ fileData,\ int32\_t\ i,\ Endianness\ endianness\ =\ Endianness::LittleEndian);}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keywordtype}{void}\ addInt16ToFileData(std::vector<uint8\_t>\&\ fileData,\ int16\_t\ i,\ Endianness\ endianness\ =\ Endianness::LittleEndian);}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordtype}{bool}\ writeDataToFile(std::vector<uint8\_t>\&\ fileData,\ std::string\ filePath);}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keywordtype}{void}\ reportError(std::string\ errorMessage);}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00208\ \ \ \ \ \mbox{\hyperlink{_audio_file_8h_ad18559d169602e85d0ad68da6ef8593f}{AudioFileFormat}}\ audioFileFormat;}
\DoxyCodeLine{00209\ \ \ \ \ uint32\_t\ sampleRate;}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keywordtype}{int}\ bitDepth;}
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{keywordtype}{bool}\ logErrorsToConsole\{\ \textcolor{keyword}{true}\ \};}
\DoxyCodeLine{00212\ \};}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00217\ \textcolor{comment}{//\ Pre-\/defined\ 10-\/byte\ representations\ of\ common\ sample\ rates}}
\DoxyCodeLine{00218\ \textcolor{keyword}{static}\ std::unordered\_map\ <uint32\_t,\ std::vector<uint8\_t>>\ aiffSampleRateTable\ =\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \{8000,\ \{64,\ 11,\ 250,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00220\ \ \ \ \ \{11025,\ \{64,\ 12,\ 172,\ 68,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00221\ \ \ \ \ \{16000,\ \{64,\ 12,\ 250,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00222\ \ \ \ \ \{22050,\ \{64,\ 13,\ 172,\ 68,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00223\ \ \ \ \ \{32000,\ \{64,\ 13,\ 250,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00224\ \ \ \ \ \{37800,\ \{64,\ 14,\ 147,\ 168,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00225\ \ \ \ \ \{44056,\ \{64,\ 14,\ 172,\ 24,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00226\ \ \ \ \ \{44100,\ \{64,\ 14,\ 172,\ 68,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00227\ \ \ \ \ \{47250,\ \{64,\ 14,\ 184,\ 146,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00228\ \ \ \ \ \{48000,\ \{64,\ 14,\ 187,\ 128,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00229\ \ \ \ \ \{50000,\ \{64,\ 14,\ 195,\ 80,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00230\ \ \ \ \ \{50400,\ \{64,\ 14,\ 196,\ 224,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00231\ \ \ \ \ \{88200,\ \{64,\ 15,\ 172,\ 68,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00232\ \ \ \ \ \{96000,\ \{64,\ 15,\ 187,\ 128,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00233\ \ \ \ \ \{176400,\ \{64,\ 16,\ 172,\ 68,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00234\ \ \ \ \ \{192000,\ \{64,\ 16,\ 187,\ 128,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00235\ \ \ \ \ \{352800,\ \{64,\ 17,\ 172,\ 68,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00236\ \ \ \ \ \{2822400,\ \{64,\ 20,\ 172,\ 68,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\},}
\DoxyCodeLine{00237\ \ \ \ \ \{5644800,\ \{64,\ 21,\ 172,\ 68,\ 0,\ 0,\ 0,\ 0,\ 0,\ 0\}\}}
\DoxyCodeLine{00238\ \};}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00241\ \textcolor{keyword}{enum}\ WavAudioFormat}
\DoxyCodeLine{00242\ \{}
\DoxyCodeLine{00243\ \ \ \ \ PCM\ =\ 0x0001,}
\DoxyCodeLine{00244\ \ \ \ \ IEEEFloat\ =\ 0x0003,}
\DoxyCodeLine{00245\ \ \ \ \ ALaw\ =\ 0x0006,}
\DoxyCodeLine{00246\ \ \ \ \ MULaw\ =\ 0x0007,}
\DoxyCodeLine{00247\ \ \ \ \ Extensible\ =\ 0xFFFE}
\DoxyCodeLine{00248\ \};}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00251\ \textcolor{keyword}{enum}\ AIFFAudioFormat}
\DoxyCodeLine{00252\ \{}
\DoxyCodeLine{00253\ \ \ \ \ Uncompressed,}
\DoxyCodeLine{00254\ \ \ \ \ Compressed,}
\DoxyCodeLine{00255\ \ \ \ \ Error}
\DoxyCodeLine{00256\ \};}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00259\ \textcolor{comment}{/*\ IMPLEMENTATION\ */}}
\DoxyCodeLine{00260\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00263\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00264\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a1b675666e190365d171567af45512e01}{AudioFile<T>::writePCMToBuffer}}(std::vector<uint8\_t>\&\ fileData)}
\DoxyCodeLine{00265\ \{}
\DoxyCodeLine{00266\ \ \ \ \ fileData.clear();}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ int16\_t\ audioFormat\ =\ bitDepth\ ==\ 32\ ?\ WavAudioFormat::IEEEFloat\ :\ WavAudioFormat::PCM;}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ getNumSamplesPerChannel();\ i++)}
\DoxyCodeLine{00271\ \ \ \ \ \{}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ channel\ =\ 0;\ channel\ <\ getNumChannels();\ channel++)}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 8)}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ \textcolor{keywordtype}{byte}\ =\ sampleToSingleByte(samples[channel][i]);}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(\textcolor{keywordtype}{byte});}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 16)}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int16\_t\ sampleAsInt\ =\ sampleToSixteenBitInt(samples[channel][i]);}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ addInt16ToFileData(fileData,\ sampleAsInt);}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 24)}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsIntAgain\ =\ (int32\_t)(samples[channel][i]\ *\ (T)8388608.);}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ bytes[3];}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bytes[2]\ =\ (uint8\_t)(sampleAsIntAgain\ >>\ 16)\ \&\ 0xFF;}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bytes[1]\ =\ (uint8\_t)(sampleAsIntAgain\ >>\ 8)\ \&\ 0xFF;}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bytes[0]\ =\ (uint8\_t)sampleAsIntAgain\ \&\ 0xFF;}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[0]);}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[1]);}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[2]);}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 32)}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsInt;}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (audioFormat\ ==\ WavAudioFormat::IEEEFloat)}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampleAsInt\ =\ (int32\_t)\ \textcolor{keyword}{reinterpret\_cast<}int32\_t\&\textcolor{keyword}{>}\ (samples[channel][i]);}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ assume\ PCM}}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampleAsInt\ =\ (int32\_t)(samples[channel][i]\ *\ std::numeric\_limits<int32\_t>::max());}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ addInt32ToFileData(fileData,\ sampleAsInt,\ Endianness::LittleEndian);}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}Trying\ to\ write\ a\ file\ with\ unsupported\ bit\ depth"{}});}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00314\ \ \ \ \ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00317\ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00320\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00321\ \mbox{\hyperlink{class_audio_file_ae74399e93d3f4623c7421ee10cfc0e15}{AudioFile<T>::AudioFile}}()}
\DoxyCodeLine{00322\ \{}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keyword}{static\_assert}(std::is\_floating\_point<T>::value,\ \textcolor{stringliteral}{"{}ERROR:\ This\ version\ of\ AudioFile\ only\ supports\ floating\ point\ sample\ formats"{}});}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ bitDepth\ =\ 16;}
\DoxyCodeLine{00326\ \ \ \ \ sampleRate\ =\ 44100;}
\DoxyCodeLine{00327\ \ \ \ \ samples.resize(1);}
\DoxyCodeLine{00328\ \ \ \ \ samples[0].resize(0);}
\DoxyCodeLine{00329\ \ \ \ \ audioFileFormat\ =\ AudioFileFormat::NotLoaded;}
\DoxyCodeLine{00330\ \}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00333\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00334\ uint32\_t\ \mbox{\hyperlink{class_audio_file_a8cd1b082af9db6bd180e4a63edcdefc9}{AudioFile<T>::getSampleRate}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00335\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordflow}{return}\ sampleRate;}
\DoxyCodeLine{00337\ \}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00340\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00341\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_audio_file_a514f860a956b4494ee8d8c806391d6b3}{AudioFile<T>::getNumChannels}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00342\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{int})samples.size();}
\DoxyCodeLine{00344\ \}}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00347\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00348\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a1057326fd2c2eca7cc7937f811868cf1}{AudioFile<T>::isMono}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00349\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordflow}{return}\ getNumChannels()\ ==\ 1;}
\DoxyCodeLine{00351\ \}}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00354\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00355\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a380a188d95f8f23b7622dfe222a7e8f6}{AudioFile<T>::isStereo}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00356\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keywordflow}{return}\ getNumChannels()\ ==\ 2;}
\DoxyCodeLine{00358\ \}}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00361\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00362\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_audio_file_a5495d5cb55911de54f0714e219130b48}{AudioFile<T>::getBitDepth}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00363\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keywordflow}{return}\ bitDepth;}
\DoxyCodeLine{00365\ \}}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00368\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00369\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_audio_file_ae1b5b4b7351a79dbf810bb34ede496b9}{AudioFile<T>::getNumSamplesPerChannel}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00370\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordflow}{if}\ (samples.size()\ >\ 0)}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{int})samples[0].size();}
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00375\ \}}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00378\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00379\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{class_audio_file_a5a6b01404675361b1c21c9c5fb5753d4}{AudioFile<T>::getLengthInSeconds}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00380\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{double})getNumSamplesPerChannel()\ /\ (double)sampleRate;}
\DoxyCodeLine{00382\ \}}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00385\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00386\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a7b88c68133a9ac92149c58499e026360}{AudioFile<T>::printSummary}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00387\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00388\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}|======================================|"{}}\ <<\ std::endl;}
\DoxyCodeLine{00389\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Num\ Channels:\ "{}}\ <<\ getNumChannels()\ <<\ std::endl;}
\DoxyCodeLine{00390\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Num\ Samples\ Per\ Channel:\ "{}}\ <<\ getNumSamplesPerChannel()\ <<\ std::endl;}
\DoxyCodeLine{00391\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Sample\ Rate:\ "{}}\ <<\ sampleRate\ <<\ std::endl;}
\DoxyCodeLine{00392\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Bit\ Depth:\ "{}}\ <<\ bitDepth\ <<\ std::endl;}
\DoxyCodeLine{00393\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Length\ in\ Seconds:\ "{}}\ <<\ getLengthInSeconds()\ <<\ std::endl;}
\DoxyCodeLine{00394\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}|======================================|"{}}\ <<\ std::endl;}
\DoxyCodeLine{00395\ \}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00398\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00399\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_afa0a0f7d576b0597c938c5a89746636e}{AudioFile<T>::setAudioBuffer}}(AudioBuffer\&\ newBuffer)}
\DoxyCodeLine{00400\ \{}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{keywordtype}{int}\ numChannels\ =\ (int)newBuffer.size();}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{keywordflow}{if}\ (numChannels\ <=\ 0)}
\DoxyCodeLine{00404\ \ \ \ \ \{}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}The\ buffer\ your\ are\ trying\ to\ use\ has\ no\ channels"{}});}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00407\ \ \ \ \ \}}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ numSamples\ =\ newBuffer[0].size();}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{comment}{//\ set\ the\ number\ of\ channels}}
\DoxyCodeLine{00412\ \ \ \ \ samples.resize(newBuffer.size());}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ 0;\ k\ <\ getNumChannels();\ k++)}
\DoxyCodeLine{00415\ \ \ \ \ \{}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ assert(newBuffer[k].size()\ ==\ numSamples);}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ samples[k].resize(numSamples);}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ numSamples;\ i++)}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ samples[k][i]\ =\ newBuffer[k][i];}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00424\ \ \ \ \ \}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00427\ \}}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00430\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00431\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_ac155ed12db0f3b02011a7d75b525e71a}{AudioFile<T>::setAudioBufferSize}}(\textcolor{keywordtype}{int}\ numChannels,\ \textcolor{keywordtype}{int}\ numSamples)}
\DoxyCodeLine{00432\ \{}
\DoxyCodeLine{00433\ \ \ \ \ samples.resize(numChannels);}
\DoxyCodeLine{00434\ \ \ \ \ setNumSamplesPerChannel(numSamples);}
\DoxyCodeLine{00435\ \}}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00438\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00439\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a4cff9513d49e21d25de13513564784b7}{AudioFile<T>::setNumSamplesPerChannel}}(\textcolor{keywordtype}{int}\ numSamples)}
\DoxyCodeLine{00440\ \{}
\DoxyCodeLine{00441\ \ \ \ \ \textcolor{keywordtype}{int}\ originalSize\ =\ getNumSamplesPerChannel();}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ getNumChannels();\ i++)}
\DoxyCodeLine{00444\ \ \ \ \ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ samples[i].resize(numSamples);}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ any\ new\ samples\ to\ zero}}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (numSamples\ >\ originalSize)}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ std::fill(samples[i].begin()\ +\ originalSize,\ samples[i].end(),\ (T)0.);}
\DoxyCodeLine{00450\ \ \ \ \ \}}
\DoxyCodeLine{00451\ \}}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00454\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00455\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a354018a94ae15907d7308782f2adadbb}{AudioFile<T>::setNumChannels}}(\textcolor{keywordtype}{int}\ numChannels)}
\DoxyCodeLine{00456\ \{}
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordtype}{int}\ originalNumChannels\ =\ getNumChannels();}
\DoxyCodeLine{00458\ \ \ \ \ \textcolor{keywordtype}{int}\ originalNumSamplesPerChannel\ =\ getNumSamplesPerChannel();}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \ \ samples.resize(numChannels);}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{comment}{//\ make\ sure\ any\ new\ channels\ are\ set\ to\ the\ right\ size}}
\DoxyCodeLine{00463\ \ \ \ \ \textcolor{comment}{//\ and\ filled\ with\ zeros}}
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{keywordflow}{if}\ (numChannels\ >\ originalNumChannels)}
\DoxyCodeLine{00465\ \ \ \ \ \{}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ originalNumChannels;\ i\ <\ numChannels;\ i++)}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ samples[i].resize(originalNumSamplesPerChannel);}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ std::fill(samples[i].begin(),\ samples[i].end(),\ (T)0.);}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00471\ \ \ \ \ \}}
\DoxyCodeLine{00472\ \}}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00475\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00476\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a2adf2ea23e7daeb8401e717c1b3d874b}{AudioFile<T>::setBitDepth}}(\textcolor{keywordtype}{int}\ numBitsPerSample)}
\DoxyCodeLine{00477\ \{}
\DoxyCodeLine{00478\ \ \ \ \ bitDepth\ =\ numBitsPerSample;}
\DoxyCodeLine{00479\ \}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00482\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00483\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a2d8fa306e40535113c3eba111e16483b}{AudioFile<T>::setSampleRate}}(uint32\_t\ newSampleRate)}
\DoxyCodeLine{00484\ \{}
\DoxyCodeLine{00485\ \ \ \ \ sampleRate\ =\ newSampleRate;}
\DoxyCodeLine{00486\ \}}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00489\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00490\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file_a1986c0297e4e4db99435702528e9c3c4}{AudioFile<T>::shouldLogErrorsToConsole}}(\textcolor{keywordtype}{bool}\ logErrors)}
\DoxyCodeLine{00491\ \{}
\DoxyCodeLine{00492\ \ \ \ \ logErrorsToConsole\ =\ logErrors;}
\DoxyCodeLine{00493\ \}}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00496\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00497\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a0ff16123b519a4665e9f3e7d341f0a26}{AudioFile<T>::load}}(std::string\ filePath)}
\DoxyCodeLine{00498\ \{}
\DoxyCodeLine{00499\ \ \ \ \ std::ifstream\ file(filePath,\ std::ios::binary);}
\DoxyCodeLine{00500\ }
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{comment}{//\ check\ the\ file\ exists}}
\DoxyCodeLine{00502\ \ \ \ \ \textcolor{keywordflow}{if}\ (!file.good())}
\DoxyCodeLine{00503\ \ \ \ \ \{}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ File\ doesn't\ exist\ or\ otherwise\ can't\ load\ file\(\backslash\)n"{}}\ +\ filePath);}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00506\ \ \ \ \ \}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ \ \ file.unsetf(std::ios::skipws);}
\DoxyCodeLine{00509\ \ \ \ \ std::istream\_iterator<uint8\_t>\ begin(file),\ end;}
\DoxyCodeLine{00510\ \ \ \ \ std::vector<uint8\_t>\ fileData(begin,\ end);}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{comment}{//\ get\ audio\ file\ format}}
\DoxyCodeLine{00513\ \ \ \ \ audioFileFormat\ =\ determineAudioFileFormat(fileData);}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keywordflow}{if}\ (audioFileFormat\ ==\ AudioFileFormat::Wave)}
\DoxyCodeLine{00516\ \ \ \ \ \{}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ decodeWaveFile(fileData);}
\DoxyCodeLine{00518\ \ \ \ \ \}}
\DoxyCodeLine{00519\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (audioFileFormat\ ==\ AudioFileFormat::Aiff)}
\DoxyCodeLine{00520\ \ \ \ \ \{}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ decodeAiffFile(fileData);}
\DoxyCodeLine{00522\ \ \ \ \ \}}
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00524\ \ \ \ \ \{}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}Audio\ File\ Type:\ Error"{}});}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00527\ \ \ \ \ \}}
\DoxyCodeLine{00528\ \}}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00531\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00532\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::decodeWaveFile}}(std::vector<uint8\_t>\&\ fileData)}
\DoxyCodeLine{00533\ \{}
\DoxyCodeLine{00534\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{comment}{//\ HEADER\ CHUNK}}
\DoxyCodeLine{00536\ \ \ \ \ std::string\ headerChunkID(fileData.begin(),\ fileData.begin()\ +\ 4);}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{comment}{//int32\_t\ fileSizeInBytes\ =\ fourBytesToInt\ (fileData,\ 4)\ +\ 8;}}
\DoxyCodeLine{00538\ \ \ \ \ std::string\ format(fileData.begin()\ +\ 8,\ fileData.begin()\ +\ 12);}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{comment}{//\ try\ and\ find\ the\ start\ points\ of\ key\ chunks}}
\DoxyCodeLine{00542\ \ \ \ \ \textcolor{keywordtype}{int}\ indexOfDataChunk\ =\ getIndexOfChunk(fileData,\ \textcolor{stringliteral}{"{}data"{}},\ 12);}
\DoxyCodeLine{00543\ \ \ \ \ \textcolor{keywordtype}{int}\ indexOfFormatChunk\ =\ getIndexOfChunk(fileData,\ \textcolor{stringliteral}{"{}fmt\ "{}},\ 12);}
\DoxyCodeLine{00544\ \ \ \ \ \textcolor{keywordtype}{int}\ indexOfXMLChunk\ =\ getIndexOfChunk(fileData,\ \textcolor{stringliteral}{"{}iXML"{}},\ 12);}
\DoxyCodeLine{00545\ }
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{comment}{//\ if\ we\ can't\ find\ the\ data\ or\ format\ chunks,\ or\ the\ IDs/formats\ don't\ seem\ to\ be\ as\ expected}}
\DoxyCodeLine{00547\ \ \ \ \ \textcolor{comment}{//\ then\ it\ is\ unlikely\ we'll\ able\ to\ read\ this\ file,\ so\ abort}}
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{keywordflow}{if}\ (indexOfDataChunk\ ==\ -\/1\ ||\ indexOfFormatChunk\ ==\ -\/1\ ||\ headerChunkID\ !=\ \textcolor{stringliteral}{"{}RIFF"{}}\ ||\ format\ !=\ \textcolor{stringliteral}{"{}WAVE"{}})}
\DoxyCodeLine{00549\ \ \ \ \ \{}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ this\ doesn't\ seem\ to\ be\ a\ valid\ .WAV\ file"{}});}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00552\ \ \ \ \ \}}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00555\ \ \ \ \ \textcolor{comment}{//\ FORMAT\ CHUNK}}
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{keywordtype}{int}\ f\ =\ indexOfFormatChunk;}
\DoxyCodeLine{00557\ \ \ \ \ std::string\ formatChunkID(fileData.begin()\ +\ f,\ fileData.begin()\ +\ f\ +\ 4);}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{comment}{//int32\_t\ formatChunkSize\ =\ fourBytesToInt\ (fileData,\ f\ +\ 4);}}
\DoxyCodeLine{00559\ \ \ \ \ int16\_t\ audioFormat\ =\ twoBytesToInt(fileData,\ f\ +\ 8);}
\DoxyCodeLine{00560\ \ \ \ \ int16\_t\ numChannels\ =\ twoBytesToInt(fileData,\ f\ +\ 10);}
\DoxyCodeLine{00561\ \ \ \ \ sampleRate\ =\ (uint32\_t)fourBytesToInt(fileData,\ f\ +\ 12);}
\DoxyCodeLine{00562\ \ \ \ \ int32\_t\ numBytesPerSecond\ =\ fourBytesToInt(fileData,\ f\ +\ 16);}
\DoxyCodeLine{00563\ \ \ \ \ int16\_t\ numBytesPerBlock\ =\ twoBytesToInt(fileData,\ f\ +\ 20);}
\DoxyCodeLine{00564\ \ \ \ \ bitDepth\ =\ (int)twoBytesToInt(fileData,\ f\ +\ 22);}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \ \ \ \ \textcolor{keywordtype}{int}\ numBytesPerSample\ =\ bitDepth\ /\ 8;}
\DoxyCodeLine{00567\ }
\DoxyCodeLine{00568\ \ \ \ \ \textcolor{comment}{//\ check\ that\ the\ audio\ format\ is\ PCM\ or\ Float}}
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{keywordflow}{if}\ (audioFormat\ !=\ WavAudioFormat::PCM\ \&\&\ audioFormat\ !=\ WavAudioFormat::IEEEFloat)}
\DoxyCodeLine{00570\ \ \ \ \ \{}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ this\ .WAV\ file\ is\ encoded\ in\ a\ format\ that\ this\ library\ does\ not\ support\ at\ present"{}});}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00573\ \ \ \ \ \}}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{comment}{//\ check\ the\ number\ of\ channels\ is\ mono\ or\ stereo}}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keywordflow}{if}\ (numChannels\ <\ 1\ ||\ numChannels\ >\ 128)}
\DoxyCodeLine{00577\ \ \ \ \ \{}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ this\ WAV\ file\ seems\ to\ be\ an\ invalid\ number\ of\ channels\ (or\ corrupted?)"{}});}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00580\ \ \ \ \ \}}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00582\ \ \ \ \ \textcolor{comment}{//\ check\ header\ data\ is\ consistent}}
\DoxyCodeLine{00583\ \ \ \ \ \textcolor{keywordflow}{if}\ ((numBytesPerSecond\ !=\ (numChannels\ *\ sampleRate\ *\ bitDepth)\ /\ 8)\ ||\ (numBytesPerBlock\ !=\ (numChannels\ *\ numBytesPerSample)))}
\DoxyCodeLine{00584\ \ \ \ \ \{}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ the\ header\ data\ in\ this\ WAV\ file\ seems\ to\ be\ inconsistent"{}});}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00587\ \ \ \ \ \}}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \ \ \textcolor{comment}{//\ check\ bit\ depth\ is\ either\ 8,\ 16,\ 24\ or\ 32\ bit}}
\DoxyCodeLine{00590\ \ \ \ \ \textcolor{keywordflow}{if}\ (bitDepth\ !=\ 8\ \&\&\ bitDepth\ !=\ 16\ \&\&\ bitDepth\ !=\ 24\ \&\&\ bitDepth\ !=\ 32)}
\DoxyCodeLine{00591\ \ \ \ \ \{}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ this\ file\ has\ a\ bit\ depth\ that\ is\ not\ 8,\ 16,\ 24\ or\ 32\ bits"{}});}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00594\ \ \ \ \ \}}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00597\ \ \ \ \ \textcolor{comment}{//\ DATA\ CHUNK}}
\DoxyCodeLine{00598\ \ \ \ \ \textcolor{keywordtype}{int}\ d\ =\ indexOfDataChunk;}
\DoxyCodeLine{00599\ \ \ \ \ std::string\ dataChunkID(fileData.begin()\ +\ d,\ fileData.begin()\ +\ d\ +\ 4);}
\DoxyCodeLine{00600\ \ \ \ \ int32\_t\ dataChunkSize\ =\ fourBytesToInt(fileData,\ d\ +\ 4);}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keywordtype}{int}\ numSamples\ =\ dataChunkSize\ /\ (numChannels\ *\ bitDepth\ /\ 8);}
\DoxyCodeLine{00603\ \ \ \ \ \textcolor{keywordtype}{int}\ samplesStartIndex\ =\ indexOfDataChunk\ +\ 8;}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \ \ \ \ clearAudioBuffer();}
\DoxyCodeLine{00606\ \ \ \ \ samples.resize(numChannels);}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ numSamples;\ i++)}
\DoxyCodeLine{00609\ \ \ \ \ \{}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ channel\ =\ 0;\ channel\ <\ numChannels;\ channel++)}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sampleIndex\ =\ samplesStartIndex\ +\ (numBytesPerBlock\ *\ i)\ +\ channel\ *\ numBytesPerSample;}
\DoxyCodeLine{00613\ }
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 8)}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ sample\ =\ singleByteToSample(fileData[sampleIndex]);}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ samples[channel].push\_back(sample);}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 16)}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int16\_t\ sampleAsInt\ =\ twoBytesToInt(fileData,\ sampleIndex);}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ sample\ =\ sixteenBitIntToSample(sampleAsInt);}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ samples[channel].push\_back(sample);}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 24)}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsInt\ =\ 0;}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampleAsInt\ =\ (fileData[sampleIndex\ +\ 2]\ <<\ 16)\ |\ (fileData[sampleIndex\ +\ 1]\ <<\ 8)\ |\ fileData[sampleIndex];}
\DoxyCodeLine{00629\ }
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sampleAsInt\ \&\ 0x800000)\ \textcolor{comment}{//\ \ if\ the\ 24th\ bit\ is\ set,\ this\ is\ a\ negative\ number\ in\ 24-\/bit\ world}}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampleAsInt\ =\ sampleAsInt\ |\ \string~0xFFFFFF;\ \textcolor{comment}{//\ so\ make\ sure\ sign\ is\ extended\ to\ the\ 32\ bit\ float}}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ sample\ =\ (T)sampleAsInt\ /\ (T)8388608.;}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ samples[channel].push\_back(sample);}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 32)}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsInt\ =\ fourBytesToInt(fileData,\ sampleIndex);}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ sample;}
\DoxyCodeLine{00640\ }
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (audioFormat\ ==\ WavAudioFormat::IEEEFloat)}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sample\ =\ (T)\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{float}\&\textcolor{keyword}{>}\ (sampleAsInt);}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ assume\ PCM}}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sample\ =\ (T)sampleAsInt\ /\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}\ (std::numeric\_limits<std::int32\_t>::max());}
\DoxyCodeLine{00645\ }
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ samples[channel].push\_back(sample);}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false});}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00653\ \ \ \ \ \}}
\DoxyCodeLine{00654\ }
\DoxyCodeLine{00655\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00656\ \ \ \ \ \textcolor{comment}{//\ iXML\ CHUNK}}
\DoxyCodeLine{00657\ \ \ \ \ \textcolor{keywordflow}{if}\ (indexOfXMLChunk\ !=\ -\/1)}
\DoxyCodeLine{00658\ \ \ \ \ \{}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ int32\_t\ chunkSize\ =\ fourBytesToInt(fileData,\ indexOfXMLChunk\ +\ 4);}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ iXMLChunk\ =\ std::string((\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*)\&fileData[indexOfXMLChunk\ +\ 8],\ chunkSize);}
\DoxyCodeLine{00661\ \ \ \ \ \}}
\DoxyCodeLine{00662\ }
\DoxyCodeLine{00663\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00664\ \}}
\DoxyCodeLine{00665\ }
\DoxyCodeLine{00666\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00667\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00668\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::decodeAiffFile}}(std::vector<uint8\_t>\&\ fileData)}
\DoxyCodeLine{00669\ \{}
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00671\ \ \ \ \ \textcolor{comment}{//\ HEADER\ CHUNK}}
\DoxyCodeLine{00672\ \ \ \ \ std::string\ headerChunkID(fileData.begin(),\ fileData.begin()\ +\ 4);}
\DoxyCodeLine{00673\ \ \ \ \ \textcolor{comment}{//int32\_t\ fileSizeInBytes\ =\ fourBytesToInt\ (fileData,\ 4,\ Endianness::BigEndian)\ +\ 8;}}
\DoxyCodeLine{00674\ \ \ \ \ std::string\ format(fileData.begin()\ +\ 8,\ fileData.begin()\ +\ 12);}
\DoxyCodeLine{00675\ }
\DoxyCodeLine{00676\ \ \ \ \ \textcolor{keywordtype}{int}\ audioFormat\ =\ format\ ==\ \textcolor{stringliteral}{"{}AIFF"{}}\ ?\ AIFFAudioFormat::Uncompressed\ :\ format\ ==\ \textcolor{stringliteral}{"{}AIFC"{}}\ ?\ AIFFAudioFormat::Compressed\ :\ AIFFAudioFormat::Error;}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00679\ \ \ \ \ \textcolor{comment}{//\ try\ and\ find\ the\ start\ points\ of\ key\ chunks}}
\DoxyCodeLine{00680\ \ \ \ \ \textcolor{keywordtype}{int}\ indexOfCommChunk\ =\ getIndexOfChunk(fileData,\ \textcolor{stringliteral}{"{}COMM"{}},\ 12,\ Endianness::BigEndian);}
\DoxyCodeLine{00681\ \ \ \ \ \textcolor{keywordtype}{int}\ indexOfSoundDataChunk\ =\ getIndexOfChunk(fileData,\ \textcolor{stringliteral}{"{}SSND"{}},\ 12,\ Endianness::BigEndian);}
\DoxyCodeLine{00682\ \ \ \ \ \textcolor{keywordtype}{int}\ indexOfXMLChunk\ =\ getIndexOfChunk(fileData,\ \textcolor{stringliteral}{"{}iXML"{}},\ 12,\ Endianness::BigEndian);}
\DoxyCodeLine{00683\ }
\DoxyCodeLine{00684\ \ \ \ \ \textcolor{comment}{//\ if\ we\ can't\ find\ the\ data\ or\ format\ chunks,\ or\ the\ IDs/formats\ don't\ seem\ to\ be\ as\ expected}}
\DoxyCodeLine{00685\ \ \ \ \ \textcolor{comment}{//\ then\ it\ is\ unlikely\ we'll\ able\ to\ read\ this\ file,\ so\ abort}}
\DoxyCodeLine{00686\ \ \ \ \ \textcolor{keywordflow}{if}\ (indexOfSoundDataChunk\ ==\ -\/1\ ||\ indexOfCommChunk\ ==\ -\/1\ ||\ headerChunkID\ !=\ \textcolor{stringliteral}{"{}FORM"{}}\ ||\ audioFormat\ ==\ AIFFAudioFormat::Error)}
\DoxyCodeLine{00687\ \ \ \ \ \{}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ this\ doesn't\ seem\ to\ be\ a\ valid\ AIFF\ file"{}});}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00690\ \ \ \ \ \}}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00693\ \ \ \ \ \textcolor{comment}{//\ COMM\ CHUNK}}
\DoxyCodeLine{00694\ \ \ \ \ \textcolor{keywordtype}{int}\ p\ =\ indexOfCommChunk;}
\DoxyCodeLine{00695\ \ \ \ \ std::string\ commChunkID(fileData.begin()\ +\ p,\ fileData.begin()\ +\ p\ +\ 4);}
\DoxyCodeLine{00696\ \ \ \ \ \textcolor{comment}{//int32\_t\ commChunkSize\ =\ fourBytesToInt\ (fileData,\ p\ +\ 4,\ Endianness::BigEndian);}}
\DoxyCodeLine{00697\ \ \ \ \ int16\_t\ numChannels\ =\ twoBytesToInt(fileData,\ p\ +\ 8,\ Endianness::BigEndian);}
\DoxyCodeLine{00698\ \ \ \ \ int32\_t\ numSamplesPerChannel\ =\ fourBytesToInt(fileData,\ p\ +\ 10,\ Endianness::BigEndian);}
\DoxyCodeLine{00699\ \ \ \ \ bitDepth\ =\ (int)twoBytesToInt(fileData,\ p\ +\ 14,\ Endianness::BigEndian);}
\DoxyCodeLine{00700\ \ \ \ \ sampleRate\ =\ getAiffSampleRate(fileData,\ p\ +\ 16);}
\DoxyCodeLine{00701\ }
\DoxyCodeLine{00702\ \ \ \ \ \textcolor{comment}{//\ check\ the\ sample\ rate\ was\ properly\ decoded}}
\DoxyCodeLine{00703\ \ \ \ \ \textcolor{keywordflow}{if}\ (sampleRate\ ==\ 0)}
\DoxyCodeLine{00704\ \ \ \ \ \{}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ this\ AIFF\ file\ has\ an\ unsupported\ sample\ rate"{}});}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00707\ \ \ \ \ \}}
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{comment}{//\ check\ the\ number\ of\ channels\ is\ mono\ or\ stereo}}
\DoxyCodeLine{00710\ \ \ \ \ \textcolor{keywordflow}{if}\ (numChannels\ <\ 1\ ||\ numChannels\ >\ 2)}
\DoxyCodeLine{00711\ \ \ \ \ \{}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ this\ AIFF\ file\ seems\ to\ be\ neither\ mono\ nor\ stereo\ (perhaps\ multi-\/track,\ or\ corrupted?)"{}});}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00714\ \ \ \ \ \}}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \ \ \ \ \textcolor{comment}{//\ check\ bit\ depth\ is\ either\ 8,\ 16,\ 24\ or\ 32-\/bit}}
\DoxyCodeLine{00717\ \ \ \ \ \textcolor{keywordflow}{if}\ (bitDepth\ !=\ 8\ \&\&\ bitDepth\ !=\ 16\ \&\&\ bitDepth\ !=\ 24\ \&\&\ bitDepth\ !=\ 32)}
\DoxyCodeLine{00718\ \ \ \ \ \{}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ this\ file\ has\ a\ bit\ depth\ that\ is\ not\ 8,\ 16,\ 24\ or\ 32\ bits"{}});}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00721\ \ \ \ \ \}}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{comment}{//\ SSND\ CHUNK}}
\DoxyCodeLine{00725\ \ \ \ \ \textcolor{keywordtype}{int}\ s\ =\ indexOfSoundDataChunk;}
\DoxyCodeLine{00726\ \ \ \ \ std::string\ soundDataChunkID(fileData.begin()\ +\ s,\ fileData.begin()\ +\ s\ +\ 4);}
\DoxyCodeLine{00727\ \ \ \ \ int32\_t\ soundDataChunkSize\ =\ fourBytesToInt(fileData,\ s\ +\ 4,\ Endianness::BigEndian);}
\DoxyCodeLine{00728\ \ \ \ \ int32\_t\ offset\ =\ fourBytesToInt(fileData,\ s\ +\ 8,\ Endianness::BigEndian);}
\DoxyCodeLine{00729\ \ \ \ \ \textcolor{comment}{//int32\_t\ blockSize\ =\ fourBytesToInt\ (fileData,\ s\ +\ 12,\ Endianness::BigEndian);}}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ \ \ \textcolor{keywordtype}{int}\ numBytesPerSample\ =\ bitDepth\ /\ 8;}
\DoxyCodeLine{00732\ \ \ \ \ \textcolor{keywordtype}{int}\ numBytesPerFrame\ =\ numBytesPerSample\ *\ numChannels;}
\DoxyCodeLine{00733\ \ \ \ \ \textcolor{keywordtype}{int}\ totalNumAudioSampleBytes\ =\ numSamplesPerChannel\ *\ numBytesPerFrame;}
\DoxyCodeLine{00734\ \ \ \ \ \textcolor{keywordtype}{int}\ samplesStartIndex\ =\ s\ +\ 16\ +\ (int)offset;}
\DoxyCodeLine{00735\ }
\DoxyCodeLine{00736\ \ \ \ \ \textcolor{comment}{//\ sanity\ check\ the\ data}}
\DoxyCodeLine{00737\ \ \ \ \ \textcolor{keywordflow}{if}\ ((soundDataChunkSize\ -\/\ 8)\ !=\ totalNumAudioSampleBytes\ ||\ totalNumAudioSampleBytes\ >\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{long}\textcolor{keyword}{>}(fileData.size()\ -\/\ samplesStartIndex))}
\DoxyCodeLine{00738\ \ \ \ \ \{}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ the\ metadatafor\ this\ file\ doesn't\ seem\ right"{}});}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00741\ \ \ \ \ \}}
\DoxyCodeLine{00742\ }
\DoxyCodeLine{00743\ \ \ \ \ clearAudioBuffer();}
\DoxyCodeLine{00744\ \ \ \ \ samples.resize(numChannels);}
\DoxyCodeLine{00745\ }
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ numSamplesPerChannel;\ i++)}
\DoxyCodeLine{00747\ \ \ \ \ \{}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ channel\ =\ 0;\ channel\ <\ numChannels;\ channel++)}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sampleIndex\ =\ samplesStartIndex\ +\ (numBytesPerFrame\ *\ i)\ +\ channel\ *\ numBytesPerSample;}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 8)}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int8\_t\ sampleAsSigned8Bit\ =\ (int8\_t)fileData[sampleIndex];}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ sample\ =\ (T)sampleAsSigned8Bit\ /\ (T)128.;}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ samples[channel].push\_back(sample);}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 16)}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int16\_t\ sampleAsInt\ =\ twoBytesToInt(fileData,\ sampleIndex,\ Endianness::BigEndian);}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ sample\ =\ sixteenBitIntToSample(sampleAsInt);}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ samples[channel].push\_back(sample);}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 24)}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsInt\ =\ 0;}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampleAsInt\ =\ (fileData[sampleIndex]\ <<\ 16)\ |\ (fileData[sampleIndex\ +\ 1]\ <<\ 8)\ |\ fileData[sampleIndex\ +\ 2];}
\DoxyCodeLine{00768\ }
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sampleAsInt\ \&\ 0x800000)\ \textcolor{comment}{//\ \ if\ the\ 24th\ bit\ is\ set,\ this\ is\ a\ negative\ number\ in\ 24-\/bit\ world}}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampleAsInt\ =\ sampleAsInt\ |\ \string~0xFFFFFF;\ \textcolor{comment}{//\ so\ make\ sure\ sign\ is\ extended\ to\ the\ 32\ bit\ float}}
\DoxyCodeLine{00771\ }
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ sample\ =\ (T)sampleAsInt\ /\ (T)8388608.;}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ samples[channel].push\_back(sample);}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00775\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 32)}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsInt\ =\ fourBytesToInt(fileData,\ sampleIndex,\ Endianness::BigEndian);}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ T\ sample;}
\DoxyCodeLine{00779\ }
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (audioFormat\ ==\ AIFFAudioFormat::Compressed)}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sample\ =\ (T)\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{float}\&\textcolor{keyword}{>}\ (sampleAsInt);}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ assume\ uncompressed}}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sample\ =\ (T)sampleAsInt\ /\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}\ (std::numeric\_limits<std::int32\_t>::max());}
\DoxyCodeLine{00784\ }
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ samples[channel].push\_back(sample);}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false});}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00792\ \ \ \ \ \}}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00794\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00795\ \ \ \ \ \textcolor{comment}{//\ iXML\ CHUNK}}
\DoxyCodeLine{00796\ \ \ \ \ \textcolor{keywordflow}{if}\ (indexOfXMLChunk\ !=\ -\/1)}
\DoxyCodeLine{00797\ \ \ \ \ \{}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ int32\_t\ chunkSize\ =\ fourBytesToInt(fileData,\ indexOfXMLChunk\ +\ 4);}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ iXMLChunk\ =\ std::string((\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*)\&fileData[indexOfXMLChunk\ +\ 8],\ chunkSize);}
\DoxyCodeLine{00800\ \ \ \ \ \}}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00803\ \}}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00806\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00807\ uint32\_t\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::getAiffSampleRate}}(std::vector<uint8\_t>\&\ fileData,\ \textcolor{keywordtype}{int}\ sampleRateStartIndex)}
\DoxyCodeLine{00808\ \{}
\DoxyCodeLine{00809\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ it\ :\ aiffSampleRateTable)}
\DoxyCodeLine{00810\ \ \ \ \ \{}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tenByteMatch(fileData,\ sampleRateStartIndex,\ it.second,\ 0))}
\DoxyCodeLine{00812\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ it.first;}
\DoxyCodeLine{00813\ \ \ \ \ \}}
\DoxyCodeLine{00814\ }
\DoxyCodeLine{00815\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00816\ \}}
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00818\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00819\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00820\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::tenByteMatch}}(std::vector<uint8\_t>\&\ v1,\ \textcolor{keywordtype}{int}\ startIndex1,\ std::vector<uint8\_t>\&\ v2,\ \textcolor{keywordtype}{int}\ startIndex2)}
\DoxyCodeLine{00821\ \{}
\DoxyCodeLine{00822\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 10;\ i++)}
\DoxyCodeLine{00823\ \ \ \ \ \{}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (v1[startIndex1\ +\ i]\ !=\ v2[startIndex2\ +\ i])}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00826\ \ \ \ \ \}}
\DoxyCodeLine{00827\ }
\DoxyCodeLine{00828\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00829\ \}}
\DoxyCodeLine{00830\ }
\DoxyCodeLine{00831\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00832\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00833\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::addSampleRateToAiffData}}(std::vector<uint8\_t>\&\ fileData,\ uint32\_t\ sampleRate)}
\DoxyCodeLine{00834\ \{}
\DoxyCodeLine{00835\ \ \ \ \ \textcolor{keywordflow}{if}\ (aiffSampleRateTable.count(sampleRate)\ >\ 0)}
\DoxyCodeLine{00836\ \ \ \ \ \{}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 10;\ i++)}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(aiffSampleRateTable[sampleRate][i]);}
\DoxyCodeLine{00839\ \ \ \ \ \}}
\DoxyCodeLine{00840\ \}}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00843\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00844\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file_a415239cad5b54b4fef4a210ab79911e3}{AudioFile<T>::save}}(std::string\ filePath,\ \mbox{\hyperlink{_audio_file_8h_ad18559d169602e85d0ad68da6ef8593f}{AudioFileFormat}}\ format)}
\DoxyCodeLine{00845\ \{}
\DoxyCodeLine{00846\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ AudioFileFormat::Wave)}
\DoxyCodeLine{00847\ \ \ \ \ \{}
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ saveToWaveFile(filePath);}
\DoxyCodeLine{00849\ \ \ \ \ \}}
\DoxyCodeLine{00850\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ AudioFileFormat::Aiff)}
\DoxyCodeLine{00851\ \ \ \ \ \{}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ saveToAiffFile(filePath);}
\DoxyCodeLine{00853\ \ \ \ \ \}}
\DoxyCodeLine{00854\ }
\DoxyCodeLine{00855\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00856\ \}}
\DoxyCodeLine{00857\ }
\DoxyCodeLine{00858\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00859\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00860\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::saveToWaveFile}}(std::string\ filePath)}
\DoxyCodeLine{00861\ \{}
\DoxyCodeLine{00862\ \ \ \ \ std::vector<uint8\_t>\ fileData;}
\DoxyCodeLine{00863\ }
\DoxyCodeLine{00864\ \ \ \ \ int32\_t\ dataChunkSize\ =\ getNumSamplesPerChannel()\ *\ (getNumChannels()\ *\ bitDepth\ /\ 8);}
\DoxyCodeLine{00865\ \ \ \ \ int16\_t\ audioFormat\ =\ bitDepth\ ==\ 32\ ?\ WavAudioFormat::IEEEFloat\ :\ WavAudioFormat::PCM;}
\DoxyCodeLine{00866\ \ \ \ \ int32\_t\ formatChunkSize\ =\ audioFormat\ ==\ WavAudioFormat::PCM\ ?\ 16\ :\ 18;}
\DoxyCodeLine{00867\ \ \ \ \ int32\_t\ iXMLChunkSize\ =\ \textcolor{keyword}{static\_cast<}int32\_t\textcolor{keyword}{>}\ (iXMLChunk.size());}
\DoxyCodeLine{00868\ }
\DoxyCodeLine{00869\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00870\ \ \ \ \ \textcolor{comment}{//\ HEADER\ CHUNK}}
\DoxyCodeLine{00871\ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}RIFF"{}});}
\DoxyCodeLine{00872\ }
\DoxyCodeLine{00873\ \ \ \ \ \textcolor{comment}{//\ The\ file\ size\ in\ bytes\ is\ the\ header\ chunk\ size\ (4,\ not\ counting\ RIFF\ and\ WAVE)\ +\ the\ format}}
\DoxyCodeLine{00874\ \ \ \ \ \textcolor{comment}{//\ chunk\ size\ (24)\ +\ the\ metadata\ part\ of\ the\ data\ chunk\ plus\ the\ actual\ data\ chunk\ size}}
\DoxyCodeLine{00875\ \ \ \ \ int32\_t\ fileSizeInBytes\ =\ 4\ +\ formatChunkSize\ +\ 8\ +\ 8\ +\ dataChunkSize;}
\DoxyCodeLine{00876\ \ \ \ \ \textcolor{keywordflow}{if}\ (iXMLChunkSize\ >\ 0)}
\DoxyCodeLine{00877\ \ \ \ \ \{}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ fileSizeInBytes\ +=\ (8\ +\ iXMLChunkSize);}
\DoxyCodeLine{00879\ \ \ \ \ \}}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00881\ \ \ \ \ addInt32ToFileData(fileData,\ fileSizeInBytes);}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00883\ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}WAVE"{}});}
\DoxyCodeLine{00884\ }
\DoxyCodeLine{00885\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00886\ \ \ \ \ \textcolor{comment}{//\ FORMAT\ CHUNK}}
\DoxyCodeLine{00887\ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}fmt\ "{}});}
\DoxyCodeLine{00888\ \ \ \ \ addInt32ToFileData(fileData,\ formatChunkSize);\ \textcolor{comment}{//\ format\ chunk\ size\ (16\ for\ PCM)}}
\DoxyCodeLine{00889\ \ \ \ \ addInt16ToFileData(fileData,\ audioFormat);\ \textcolor{comment}{//\ audio\ format}}
\DoxyCodeLine{00890\ \ \ \ \ addInt16ToFileData(fileData,\ (int16\_t)getNumChannels());\ \textcolor{comment}{//\ num\ channels}}
\DoxyCodeLine{00891\ \ \ \ \ addInt32ToFileData(fileData,\ (int32\_t)sampleRate);\ \textcolor{comment}{//\ sample\ rate}}
\DoxyCodeLine{00892\ }
\DoxyCodeLine{00893\ \ \ \ \ int32\_t\ numBytesPerSecond\ =\ (int32\_t)((getNumChannels()\ *\ sampleRate\ *\ bitDepth)\ /\ 8);}
\DoxyCodeLine{00894\ \ \ \ \ addInt32ToFileData(fileData,\ numBytesPerSecond);}
\DoxyCodeLine{00895\ }
\DoxyCodeLine{00896\ \ \ \ \ int16\_t\ numBytesPerBlock\ =\ getNumChannels()\ *\ (bitDepth\ /\ 8);}
\DoxyCodeLine{00897\ \ \ \ \ addInt16ToFileData(fileData,\ numBytesPerBlock);}
\DoxyCodeLine{00898\ }
\DoxyCodeLine{00899\ \ \ \ \ addInt16ToFileData(fileData,\ (int16\_t)bitDepth);}
\DoxyCodeLine{00900\ }
\DoxyCodeLine{00901\ \ \ \ \ \textcolor{keywordflow}{if}\ (audioFormat\ ==\ WavAudioFormat::IEEEFloat)}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ addInt16ToFileData(fileData,\ 0);\ \textcolor{comment}{//\ extension\ size}}
\DoxyCodeLine{00903\ }
\DoxyCodeLine{00904\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00905\ \ \ \ \ \textcolor{comment}{//\ DATA\ CHUNK}}
\DoxyCodeLine{00906\ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}data"{}});}
\DoxyCodeLine{00907\ \ \ \ \ addInt32ToFileData(fileData,\ dataChunkSize);}
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ getNumSamplesPerChannel();\ i++)}
\DoxyCodeLine{00910\ \ \ \ \ \{}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ channel\ =\ 0;\ channel\ <\ getNumChannels();\ channel++)}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 8)}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ \textcolor{keywordtype}{byte}\ =\ sampleToSingleByte(samples[channel][i]);}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(\textcolor{keywordtype}{byte});}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 16)}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int16\_t\ sampleAsInt\ =\ sampleToSixteenBitInt(samples[channel][i]);}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ addInt16ToFileData(fileData,\ sampleAsInt);}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 24)}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00925\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsIntAgain\ =\ (int32\_t)(samples[channel][i]\ *\ (T)8388608.);}
\DoxyCodeLine{00926\ }
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ bytes[3];}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bytes[2]\ =\ (uint8\_t)(sampleAsIntAgain\ >>\ 16)\ \&\ 0xFF;}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bytes[1]\ =\ (uint8\_t)(sampleAsIntAgain\ >>\ 8)\ \&\ 0xFF;}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bytes[0]\ =\ (uint8\_t)sampleAsIntAgain\ \&\ 0xFF;}
\DoxyCodeLine{00931\ }
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[0]);}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[1]);}
\DoxyCodeLine{00934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[2]);}
\DoxyCodeLine{00935\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00936\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 32)}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsInt;}
\DoxyCodeLine{00939\ }
\DoxyCodeLine{00940\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (audioFormat\ ==\ WavAudioFormat::IEEEFloat)}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampleAsInt\ =\ (int32\_t)\ \textcolor{keyword}{reinterpret\_cast<}int32\_t\&\textcolor{keyword}{>}\ (samples[channel][i]);}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ assume\ PCM}}
\DoxyCodeLine{00943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampleAsInt\ =\ (int32\_t)(samples[channel][i]\ *\ std::numeric\_limits<int32\_t>::max());}
\DoxyCodeLine{00944\ }
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ addInt32ToFileData(fileData,\ sampleAsInt,\ Endianness::LittleEndian);}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}Trying\ to\ write\ a\ file\ with\ unsupported\ bit\ depth"{}});}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00953\ \ \ \ \ \}}
\DoxyCodeLine{00954\ }
\DoxyCodeLine{00955\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00956\ \ \ \ \ \textcolor{comment}{//\ iXML\ CHUNK}}
\DoxyCodeLine{00957\ \ \ \ \ \textcolor{keywordflow}{if}\ (iXMLChunkSize\ >\ 0)}
\DoxyCodeLine{00958\ \ \ \ \ \{}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}iXML"{}});}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ addInt32ToFileData(fileData,\ iXMLChunkSize);}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ addStringToFileData(fileData,\ iXMLChunk);}
\DoxyCodeLine{00962\ \ \ \ \ \}}
\DoxyCodeLine{00963\ }
\DoxyCodeLine{00964\ \ \ \ \ \textcolor{comment}{//\ check\ that\ the\ various\ sizes\ we\ put\ in\ the\ metadata\ are\ correct}}
\DoxyCodeLine{00965\ \ \ \ \ \textcolor{keywordflow}{if}\ (fileSizeInBytes\ !=\ \textcolor{keyword}{static\_cast<}int32\_t\textcolor{keyword}{>}\ (fileData.size()\ -\/\ 8)\ ||\ dataChunkSize\ !=\ (getNumSamplesPerChannel()\ *\ getNumChannels()\ *\ (bitDepth\ /\ 8)))}
\DoxyCodeLine{00966\ \ \ \ \ \{}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ couldn't\ save\ file\ to\ "{}}\ +\ filePath);}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00969\ \ \ \ \ \}}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00971\ \ \ \ \ \textcolor{comment}{//\ try\ to\ write\ the\ file}}
\DoxyCodeLine{00972\ \ \ \ \ \textcolor{keywordflow}{return}\ writeDataToFile(fileData,\ filePath);}
\DoxyCodeLine{00973\ \}}
\DoxyCodeLine{00974\ }
\DoxyCodeLine{00975\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{00976\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{00977\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::saveToAiffFile}}(std::string\ filePath)}
\DoxyCodeLine{00978\ \{}
\DoxyCodeLine{00979\ \ \ \ \ std::vector<uint8\_t>\ fileData;}
\DoxyCodeLine{00980\ }
\DoxyCodeLine{00981\ \ \ \ \ int32\_t\ numBytesPerSample\ =\ bitDepth\ /\ 8;}
\DoxyCodeLine{00982\ \ \ \ \ int32\_t\ numBytesPerFrame\ =\ numBytesPerSample\ *\ getNumChannels();}
\DoxyCodeLine{00983\ \ \ \ \ int32\_t\ totalNumAudioSampleBytes\ =\ getNumSamplesPerChannel()\ *\ numBytesPerFrame;}
\DoxyCodeLine{00984\ \ \ \ \ int32\_t\ soundDataChunkSize\ =\ totalNumAudioSampleBytes\ +\ 8;}
\DoxyCodeLine{00985\ \ \ \ \ int32\_t\ iXMLChunkSize\ =\ \textcolor{keyword}{static\_cast<}int32\_t\textcolor{keyword}{>}\ (iXMLChunk.size());}
\DoxyCodeLine{00986\ }
\DoxyCodeLine{00987\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00988\ \ \ \ \ \textcolor{comment}{//\ HEADER\ CHUNK}}
\DoxyCodeLine{00989\ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}FORM"{}});}
\DoxyCodeLine{00990\ }
\DoxyCodeLine{00991\ \ \ \ \ \textcolor{comment}{//\ The\ file\ size\ in\ bytes\ is\ the\ header\ chunk\ size\ (4,\ not\ counting\ FORM\ and\ AIFF)\ +\ the\ COMM}}
\DoxyCodeLine{00992\ \ \ \ \ \textcolor{comment}{//\ chunk\ size\ (26)\ +\ the\ metadata\ part\ of\ the\ SSND\ chunk\ plus\ the\ actual\ data\ chunk\ size}}
\DoxyCodeLine{00993\ \ \ \ \ int32\_t\ fileSizeInBytes\ =\ 4\ +\ 26\ +\ 16\ +\ totalNumAudioSampleBytes;}
\DoxyCodeLine{00994\ \ \ \ \ \textcolor{keywordflow}{if}\ (iXMLChunkSize\ >\ 0)}
\DoxyCodeLine{00995\ \ \ \ \ \{}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \ \ fileSizeInBytes\ +=\ (8\ +\ iXMLChunkSize);}
\DoxyCodeLine{00997\ \ \ \ \ \}}
\DoxyCodeLine{00998\ }
\DoxyCodeLine{00999\ \ \ \ \ addInt32ToFileData(fileData,\ fileSizeInBytes,\ Endianness::BigEndian);}
\DoxyCodeLine{01000\ }
\DoxyCodeLine{01001\ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}AIFF"{}});}
\DoxyCodeLine{01002\ }
\DoxyCodeLine{01003\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{01004\ \ \ \ \ \textcolor{comment}{//\ COMM\ CHUNK}}
\DoxyCodeLine{01005\ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}COMM"{}});}
\DoxyCodeLine{01006\ \ \ \ \ addInt32ToFileData(fileData,\ 18,\ Endianness::BigEndian);\ \textcolor{comment}{//\ commChunkSize}}
\DoxyCodeLine{01007\ \ \ \ \ addInt16ToFileData(fileData,\ getNumChannels(),\ Endianness::BigEndian);\ \textcolor{comment}{//\ num\ channels}}
\DoxyCodeLine{01008\ \ \ \ \ addInt32ToFileData(fileData,\ getNumSamplesPerChannel(),\ Endianness::BigEndian);\ \textcolor{comment}{//\ num\ samples\ per\ channel}}
\DoxyCodeLine{01009\ \ \ \ \ addInt16ToFileData(fileData,\ bitDepth,\ Endianness::BigEndian);\ \textcolor{comment}{//\ bit\ depth}}
\DoxyCodeLine{01010\ \ \ \ \ addSampleRateToAiffData(fileData,\ sampleRate);}
\DoxyCodeLine{01011\ }
\DoxyCodeLine{01012\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{01013\ \ \ \ \ \textcolor{comment}{//\ SSND\ CHUNK}}
\DoxyCodeLine{01014\ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}SSND"{}});}
\DoxyCodeLine{01015\ \ \ \ \ addInt32ToFileData(fileData,\ soundDataChunkSize,\ Endianness::BigEndian);}
\DoxyCodeLine{01016\ \ \ \ \ addInt32ToFileData(fileData,\ 0,\ Endianness::BigEndian);\ \textcolor{comment}{//\ offset}}
\DoxyCodeLine{01017\ \ \ \ \ addInt32ToFileData(fileData,\ 0,\ Endianness::BigEndian);\ \textcolor{comment}{//\ block\ size}}
\DoxyCodeLine{01018\ }
\DoxyCodeLine{01019\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ getNumSamplesPerChannel();\ i++)}
\DoxyCodeLine{01020\ \ \ \ \ \{}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ channel\ =\ 0;\ channel\ <\ getNumChannels();\ channel++)}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01023\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 8)}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ \textcolor{keywordtype}{byte}\ =\ sampleToSingleByte(samples[channel][i]);}
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(\textcolor{keywordtype}{byte});}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01028\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 16)}
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int16\_t\ sampleAsInt\ =\ sampleToSixteenBitInt(samples[channel][i]);}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ addInt16ToFileData(fileData,\ sampleAsInt,\ Endianness::BigEndian);}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 24)}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsIntAgain\ =\ (int32\_t)(samples[channel][i]\ *\ (T)8388608.);}
\DoxyCodeLine{01036\ }
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ bytes[3];}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bytes[0]\ =\ (uint8\_t)(sampleAsIntAgain\ >>\ 16)\ \&\ 0xFF;}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bytes[1]\ =\ (uint8\_t)(sampleAsIntAgain\ >>\ 8)\ \&\ 0xFF;}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bytes[2]\ =\ (uint8\_t)sampleAsIntAgain\ \&\ 0xFF;}
\DoxyCodeLine{01041\ }
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[0]);}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[1]);}
\DoxyCodeLine{01044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[2]);}
\DoxyCodeLine{01045\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01046\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (bitDepth\ ==\ 32)}
\DoxyCodeLine{01047\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ write\ samples\ as\ signed\ integers\ (no\ implementation\ yet\ for\ floating\ point,\ but\ looking\ at\ WAV\ implementation\ should\ help)}}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ sampleAsInt\ =\ (int32\_t)(samples[channel][i]\ *\ std::numeric\_limits<int32\_t>::max());}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ addInt32ToFileData(fileData,\ sampleAsInt,\ Endianness::BigEndian);}
\DoxyCodeLine{01051\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01052\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}Trying\ to\ write\ a\ file\ with\ unsupported\ bit\ depth"{}});}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01058\ \ \ \ \ \}}
\DoxyCodeLine{01059\ }
\DoxyCodeLine{01060\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{01061\ \ \ \ \ \textcolor{comment}{//\ iXML\ CHUNK}}
\DoxyCodeLine{01062\ \ \ \ \ \textcolor{keywordflow}{if}\ (iXMLChunkSize\ >\ 0)}
\DoxyCodeLine{01063\ \ \ \ \ \{}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ addStringToFileData(fileData,\ \textcolor{stringliteral}{"{}iXML"{}});}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ addInt32ToFileData(fileData,\ iXMLChunkSize);}
\DoxyCodeLine{01066\ \ \ \ \ \ \ \ \ addStringToFileData(fileData,\ iXMLChunk);}
\DoxyCodeLine{01067\ \ \ \ \ \}}
\DoxyCodeLine{01068\ }
\DoxyCodeLine{01069\ \ \ \ \ \textcolor{comment}{//\ check\ that\ the\ various\ sizes\ we\ put\ in\ the\ metadata\ are\ correct}}
\DoxyCodeLine{01070\ \ \ \ \ \textcolor{keywordflow}{if}\ (fileSizeInBytes\ !=\ \textcolor{keyword}{static\_cast<}int32\_t\textcolor{keyword}{>}\ (fileData.size()\ -\/\ 8)\ ||\ soundDataChunkSize\ !=\ getNumSamplesPerChannel()\ *\ numBytesPerFrame\ +\ 8)}
\DoxyCodeLine{01071\ \ \ \ \ \{}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \ \ reportError(\textcolor{stringliteral}{"{}ERROR:\ couldn't\ save\ file\ to\ "{}}\ +\ filePath);}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01074\ \ \ \ \ \}}
\DoxyCodeLine{01075\ }
\DoxyCodeLine{01076\ \ \ \ \ \textcolor{comment}{//\ try\ to\ write\ the\ file}}
\DoxyCodeLine{01077\ \ \ \ \ \textcolor{keywordflow}{return}\ writeDataToFile(fileData,\ filePath);}
\DoxyCodeLine{01078\ \}}
\DoxyCodeLine{01079\ }
\DoxyCodeLine{01080\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01081\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01082\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::writeDataToFile}}(std::vector<uint8\_t>\&\ fileData,\ std::string\ filePath)}
\DoxyCodeLine{01083\ \{}
\DoxyCodeLine{01084\ \ \ \ \ std::ofstream\ outputFile(filePath,\ std::ios::binary);}
\DoxyCodeLine{01085\ }
\DoxyCodeLine{01086\ \ \ \ \ \textcolor{keywordflow}{if}\ (outputFile.is\_open())}
\DoxyCodeLine{01087\ \ \ \ \ \{}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ fileData.size();\ i++)}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ value\ =\ (char)fileData[i];}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ \ \ \ \ outputFile.write(\&value,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}));}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01093\ }
\DoxyCodeLine{01094\ \ \ \ \ \ \ \ \ outputFile.close();}
\DoxyCodeLine{01095\ }
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01097\ \ \ \ \ \}}
\DoxyCodeLine{01098\ }
\DoxyCodeLine{01099\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01100\ \}}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01103\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01104\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::addStringToFileData}}(std::vector<uint8\_t>\&\ fileData,\ std::string\ s)}
\DoxyCodeLine{01105\ \{}
\DoxyCodeLine{01106\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ s.length();\ i++)}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \ \ fileData.push\_back((uint8\_t)s[i]);}
\DoxyCodeLine{01108\ \}}
\DoxyCodeLine{01109\ }
\DoxyCodeLine{01110\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01111\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01112\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::addInt32ToFileData}}(std::vector<uint8\_t>\&\ fileData,\ int32\_t\ i,\ Endianness\ endianness)}
\DoxyCodeLine{01113\ \{}
\DoxyCodeLine{01114\ \ \ \ \ uint8\_t\ bytes[4];}
\DoxyCodeLine{01115\ }
\DoxyCodeLine{01116\ \ \ \ \ \textcolor{keywordflow}{if}\ (endianness\ ==\ Endianness::LittleEndian)}
\DoxyCodeLine{01117\ \ \ \ \ \{}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ bytes[3]\ =\ (i\ >>\ 24)\ \&\ 0xFF;}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ bytes[2]\ =\ (i\ >>\ 16)\ \&\ 0xFF;}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ bytes[1]\ =\ (i\ >>\ 8)\ \&\ 0xFF;}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ bytes[0]\ =\ i\ \&\ 0xFF;}
\DoxyCodeLine{01122\ \ \ \ \ \}}
\DoxyCodeLine{01123\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01124\ \ \ \ \ \{}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ bytes[0]\ =\ (i\ >>\ 24)\ \&\ 0xFF;}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ bytes[1]\ =\ (i\ >>\ 16)\ \&\ 0xFF;}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ bytes[2]\ =\ (i\ >>\ 8)\ \&\ 0xFF;}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ bytes[3]\ =\ i\ \&\ 0xFF;}
\DoxyCodeLine{01129\ \ \ \ \ \}}
\DoxyCodeLine{01130\ }
\DoxyCodeLine{01131\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 4;\ i++)}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ fileData.push\_back(bytes[i]);}
\DoxyCodeLine{01133\ \}}
\DoxyCodeLine{01134\ }
\DoxyCodeLine{01135\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01136\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01137\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::addInt16ToFileData}}(std::vector<uint8\_t>\&\ fileData,\ int16\_t\ i,\ Endianness\ endianness)}
\DoxyCodeLine{01138\ \{}
\DoxyCodeLine{01139\ \ \ \ \ uint8\_t\ bytes[2];}
\DoxyCodeLine{01140\ }
\DoxyCodeLine{01141\ \ \ \ \ \textcolor{keywordflow}{if}\ (endianness\ ==\ Endianness::LittleEndian)}
\DoxyCodeLine{01142\ \ \ \ \ \{}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \ \ bytes[1]\ =\ (i\ >>\ 8)\ \&\ 0xFF;}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ bytes[0]\ =\ i\ \&\ 0xFF;}
\DoxyCodeLine{01145\ \ \ \ \ \}}
\DoxyCodeLine{01146\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01147\ \ \ \ \ \{}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \ \ bytes[0]\ =\ (i\ >>\ 8)\ \&\ 0xFF;}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \ \ bytes[1]\ =\ i\ \&\ 0xFF;}
\DoxyCodeLine{01150\ \ \ \ \ \}}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \ \ fileData.push\_back(bytes[0]);}
\DoxyCodeLine{01153\ \ \ \ \ fileData.push\_back(bytes[1]);}
\DoxyCodeLine{01154\ \}}
\DoxyCodeLine{01155\ }
\DoxyCodeLine{01156\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01157\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01158\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::clearAudioBuffer}}()}
\DoxyCodeLine{01159\ \{}
\DoxyCodeLine{01160\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ samples.size();\ i++)}
\DoxyCodeLine{01161\ \ \ \ \ \{}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \ \ samples[i].clear();}
\DoxyCodeLine{01163\ \ \ \ \ \}}
\DoxyCodeLine{01164\ }
\DoxyCodeLine{01165\ \ \ \ \ samples.clear();}
\DoxyCodeLine{01166\ \}}
\DoxyCodeLine{01167\ }
\DoxyCodeLine{01168\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01169\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01170\ \mbox{\hyperlink{_audio_file_8h_ad18559d169602e85d0ad68da6ef8593f}{AudioFileFormat}}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::determineAudioFileFormat}}(std::vector<uint8\_t>\&\ fileData)}
\DoxyCodeLine{01171\ \{}
\DoxyCodeLine{01172\ \ \ \ \ std::string\ header(fileData.begin(),\ fileData.begin()\ +\ 4);}
\DoxyCodeLine{01173\ }
\DoxyCodeLine{01174\ \ \ \ \ \textcolor{keywordflow}{if}\ (header\ ==\ \textcolor{stringliteral}{"{}RIFF"{}})}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ AudioFileFormat::Wave;}
\DoxyCodeLine{01176\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (header\ ==\ \textcolor{stringliteral}{"{}FORM"{}})}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ AudioFileFormat::Aiff;}
\DoxyCodeLine{01178\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ AudioFileFormat::Error;}
\DoxyCodeLine{01180\ \}}
\DoxyCodeLine{01181\ }
\DoxyCodeLine{01182\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01183\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01184\ int32\_t\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::fourBytesToInt}}(std::vector<uint8\_t>\&\ source,\ \textcolor{keywordtype}{int}\ startIndex,\ Endianness\ endianness)}
\DoxyCodeLine{01185\ \{}
\DoxyCodeLine{01186\ \ \ \ \ int32\_t\ result;}
\DoxyCodeLine{01187\ }
\DoxyCodeLine{01188\ \ \ \ \ \textcolor{keywordflow}{if}\ (endianness\ ==\ Endianness::LittleEndian)}
\DoxyCodeLine{01189\ \ \ \ \ \ \ \ \ result\ =\ (source[startIndex\ +\ 3]\ <<\ 24)\ |\ (source[startIndex\ +\ 2]\ <<\ 16)\ |\ (source[startIndex\ +\ 1]\ <<\ 8)\ |\ source[startIndex];}
\DoxyCodeLine{01190\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01191\ \ \ \ \ \ \ \ \ result\ =\ (source[startIndex]\ <<\ 24)\ |\ (source[startIndex\ +\ 1]\ <<\ 16)\ |\ (source[startIndex\ +\ 2]\ <<\ 8)\ |\ source[startIndex\ +\ 3];}
\DoxyCodeLine{01192\ }
\DoxyCodeLine{01193\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01194\ \}}
\DoxyCodeLine{01195\ }
\DoxyCodeLine{01196\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01197\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01198\ int16\_t\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::twoBytesToInt}}(std::vector<uint8\_t>\&\ source,\ \textcolor{keywordtype}{int}\ startIndex,\ Endianness\ endianness)}
\DoxyCodeLine{01199\ \{}
\DoxyCodeLine{01200\ \ \ \ \ int16\_t\ result;}
\DoxyCodeLine{01201\ }
\DoxyCodeLine{01202\ \ \ \ \ \textcolor{keywordflow}{if}\ (endianness\ ==\ Endianness::LittleEndian)}
\DoxyCodeLine{01203\ \ \ \ \ \ \ \ \ result\ =\ (source[startIndex\ +\ 1]\ <<\ 8)\ |\ source[startIndex];}
\DoxyCodeLine{01204\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ result\ =\ (source[startIndex]\ <<\ 8)\ |\ source[startIndex\ +\ 1];}
\DoxyCodeLine{01206\ }
\DoxyCodeLine{01207\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01208\ \}}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01211\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01212\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::getIndexOfString}}(std::vector<uint8\_t>\&\ source,\ std::string\ stringToSearchFor)}
\DoxyCodeLine{01213\ \{}
\DoxyCodeLine{01214\ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ -\/1;}
\DoxyCodeLine{01215\ \ \ \ \ \textcolor{keywordtype}{int}\ stringLength\ =\ (int)stringToSearchFor.length();}
\DoxyCodeLine{01216\ }
\DoxyCodeLine{01217\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ source.size()\ -\/\ stringLength;\ i++)}
\DoxyCodeLine{01218\ \ \ \ \ \{}
\DoxyCodeLine{01219\ \ \ \ \ \ \ \ \ std::string\ section(source.begin()\ +\ i,\ source.begin()\ +\ i\ +\ stringLength);}
\DoxyCodeLine{01220\ }
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (section\ ==\ stringToSearchFor)}
\DoxyCodeLine{01222\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01223\ \ \ \ \ \ \ \ \ \ \ \ \ index\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}\ (i);}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01226\ \ \ \ \ \}}
\DoxyCodeLine{01227\ }
\DoxyCodeLine{01228\ \ \ \ \ \textcolor{keywordflow}{return}\ index;}
\DoxyCodeLine{01229\ \}}
\DoxyCodeLine{01230\ }
\DoxyCodeLine{01231\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01232\ \textcolor{comment}{//template\ <class\ T>}}
\DoxyCodeLine{01233\ \textcolor{comment}{//int\ AudioFile<T>::getIndexOfChunk\ (std::vector<uint8\_t>\&\ source,\ const\ std::string\&\ chunkHeaderID,\ int\ startIndex,\ Endianness\ endianness)}}
\DoxyCodeLine{01234\ \textcolor{comment}{//\{}}
\DoxyCodeLine{01235\ \textcolor{comment}{//\ \ \ \ constexpr\ int\ dataLen\ =\ 4;}}
\DoxyCodeLine{01236\ \textcolor{comment}{//\ \ \ \ if\ (chunkHeaderID.size()\ !=\ dataLen)}}
\DoxyCodeLine{01237\ \textcolor{comment}{//\ \ \ \ \{}}
\DoxyCodeLine{01238\ \textcolor{comment}{//\ \ \ \ \ \ \ \ assert\ (false\ \&\&\ "{}Invalid\ chunk\ header\ ID\ string"{});}}
\DoxyCodeLine{01239\ \textcolor{comment}{//\ \ \ \ \ \ \ \ return\ -\/1;}}
\DoxyCodeLine{01240\ \textcolor{comment}{//\ \ \ \ \}}}
\DoxyCodeLine{01241\ \textcolor{comment}{//}}
\DoxyCodeLine{01242\ \textcolor{comment}{//\ \ \ \ int\ i\ =\ startIndex;}}
\DoxyCodeLine{01243\ \textcolor{comment}{//\ \ \ \ while\ (i\ <\ source.size()\ -\/\ dataLen)}}
\DoxyCodeLine{01244\ \textcolor{comment}{//\ \ \ \ \{}}
\DoxyCodeLine{01245\ \textcolor{comment}{//\ \ \ \ \ \ \ \ if\ (memcmp\ (\&source[i],\ chunkHeaderID.data(),\ dataLen)\ ==\ 0)}}
\DoxyCodeLine{01246\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{01247\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ return\ i;}}
\DoxyCodeLine{01248\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{01249\ \textcolor{comment}{//}}
\DoxyCodeLine{01250\ \textcolor{comment}{//\ \ \ \ \ \ \ \ i\ +=\ dataLen;}}
\DoxyCodeLine{01251\ \textcolor{comment}{//\ \ \ \ \ \ \ \ auto\ chunkSize\ =\ fourBytesToInt\ (source,\ i,\ endianness);}}
\DoxyCodeLine{01252\ \textcolor{comment}{//\ \ \ \ \ \ \ \ i\ +=\ (dataLen\ +\ chunkSize);}}
\DoxyCodeLine{01253\ \textcolor{comment}{//\ \ \ \ \}}}
\DoxyCodeLine{01254\ \textcolor{comment}{//}}
\DoxyCodeLine{01255\ \textcolor{comment}{//\ \ \ \ return\ -\/1;}}
\DoxyCodeLine{01256\ \textcolor{comment}{//\}}}
\DoxyCodeLine{01257\ }
\DoxyCodeLine{01258\ }
\DoxyCodeLine{01259\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01260\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::getIndexOfChunk}}(std::vector<uint8\_t>\&\ source,\ \textcolor{keyword}{const}\ std::string\&\ chunkHeaderID,\ \textcolor{keywordtype}{int}\ startIndex,\ Endianness\ endianness)}
\DoxyCodeLine{01261\ \{}
\DoxyCodeLine{01262\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ dataLen\ =\ 4;}
\DoxyCodeLine{01263\ \ \ \ \ \textcolor{keywordflow}{if}\ (chunkHeaderID.size()\ !=\ dataLen\ ||\ startIndex\ <\ 0)}
\DoxyCodeLine{01264\ \ \ \ \ \{}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ assert(\textcolor{keyword}{false}\ \&\&\ \textcolor{stringliteral}{"{}Invalid\ chunk\ header\ ID\ string"{}});}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01267\ \ \ \ \ \}}
\DoxyCodeLine{01268\ }
\DoxyCodeLine{01269\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ i\ =\ size\_t(startIndex);}
\DoxyCodeLine{01270\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ <\ source.size()\ -\/\ dataLen)}
\DoxyCodeLine{01271\ \ \ \ \ \{}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (memcmp(\&source[i],\ chunkHeaderID.data(),\ dataLen)\ ==\ 0)}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{int})i;}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01276\ }
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ i\ +=\ dataLen;}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ chunkSize\ =\ fourBytesToInt(source,\ i,\ endianness);}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ i\ +=\ (dataLen\ +\ chunkSize);}
\DoxyCodeLine{01280\ \ \ \ \ \}}
\DoxyCodeLine{01281\ }
\DoxyCodeLine{01282\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{01283\ \}}
\DoxyCodeLine{01284\ }
\DoxyCodeLine{01285\ }
\DoxyCodeLine{01286\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01287\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01288\ T\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::sixteenBitIntToSample}}(int16\_t\ sample)}
\DoxyCodeLine{01289\ \{}
\DoxyCodeLine{01290\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}\ (sample)\ /\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}\ (32768.);}
\DoxyCodeLine{01291\ \}}
\DoxyCodeLine{01292\ }
\DoxyCodeLine{01293\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01294\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01295\ int16\_t\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::sampleToSixteenBitInt}}(T\ sample)}
\DoxyCodeLine{01296\ \{}
\DoxyCodeLine{01297\ \ \ \ \ sample\ =\ clamp(sample,\ -\/1.,\ 1.);}
\DoxyCodeLine{01298\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}int16\_t\textcolor{keyword}{>}\ (sample\ *\ 32767.);}
\DoxyCodeLine{01299\ \}}
\DoxyCodeLine{01300\ }
\DoxyCodeLine{01301\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01302\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01303\ uint8\_t\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::sampleToSingleByte}}(T\ sample)}
\DoxyCodeLine{01304\ \{}
\DoxyCodeLine{01305\ \ \ \ \ sample\ =\ clamp(sample,\ -\/1.,\ 1.);}
\DoxyCodeLine{01306\ \ \ \ \ sample\ =\ (sample\ +\ 1.)\ /\ 2.;}
\DoxyCodeLine{01307\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}uint8\_t\textcolor{keyword}{>}\ (sample\ *\ 255.);}
\DoxyCodeLine{01308\ \}}
\DoxyCodeLine{01309\ }
\DoxyCodeLine{01310\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01311\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01312\ T\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::singleByteToSample}}(uint8\_t\ sample)}
\DoxyCodeLine{01313\ \{}
\DoxyCodeLine{01314\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}\ (sample\ -\/\ 128)\ /\ \textcolor{keyword}{static\_cast<}T\textcolor{keyword}{>}\ (128.);}
\DoxyCodeLine{01315\ \}}
\DoxyCodeLine{01316\ }
\DoxyCodeLine{01317\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01318\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01319\ T\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::clamp}}(T\ value,\ T\ minValue,\ T\ maxValue)}
\DoxyCodeLine{01320\ \{}
\DoxyCodeLine{01321\ \ \ \ \ value\ =\ std::min(value,\ maxValue);}
\DoxyCodeLine{01322\ \ \ \ \ value\ =\ std::max(value,\ minValue);}
\DoxyCodeLine{01323\ \ \ \ \ \textcolor{keywordflow}{return}\ value;}
\DoxyCodeLine{01324\ \}}
\DoxyCodeLine{01325\ }
\DoxyCodeLine{01326\ \textcolor{comment}{//=============================================================}}
\DoxyCodeLine{01327\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T>}
\DoxyCodeLine{01328\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_audio_file}{AudioFile<T>::reportError}}(std::string\ errorMessage)}
\DoxyCodeLine{01329\ \{}
\DoxyCodeLine{01330\ \ \ \ \ \textcolor{keywordflow}{if}\ (logErrorsToConsole)}
\DoxyCodeLine{01331\ \ \ \ \ \ \ \ \ std::cout\ <<\ errorMessage\ <<\ std::endl;}
\DoxyCodeLine{01332\ \}}
\DoxyCodeLine{01333\ }
\DoxyCodeLine{01334\ \textcolor{preprocessor}{\#if\ defined\ (\_MSC\_VER)}}
\DoxyCodeLine{01335\ \_\_pragma(warning(pop))}
\DoxyCodeLine{01336\ \textcolor{preprocessor}{\#elif\ defined\ (\_\_GNUC\_\_)}}
\DoxyCodeLine{01337\ \_Pragma(\textcolor{stringliteral}{"{}GCC\ diagnostic\ pop"{}})}
\DoxyCodeLine{01338\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01339\ }
\DoxyCodeLine{01340\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ AudioFile\_h\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
